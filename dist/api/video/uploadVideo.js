var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.uploadVideoMobile=uploadVideoMobile;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _axios=_interopRequireDefault(require("axios"));var Mime=_interopRequireWildcard(require("react-native-mime-types"));function _interopRequireWildcard(e,t){if("function"==typeof WeakMap)var r=new WeakMap(),n=new WeakMap();return(_interopRequireWildcard=function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;var o,i,f={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return f;if(o=t?n:r){if(o.has(e))return o.get(e);o.set(e,f);}for(var _t in e)"default"!==_t&&{}.hasOwnProperty.call(e,_t)&&((i=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,_t))&&(i.get||i.set)?o(f,_t,i):f[_t]=e[_t]);return f;})(e,t);}function uploadVideoMobile(_x){return _uploadVideoMobile.apply(this,arguments);}function _uploadVideoMobile(){_uploadVideoMobile=(0,_asyncToGenerator2.default)(function*(_ref){var title=_ref.title,description=_ref.description,videoUri=_ref.videoUri,thumbnailUri=_ref.thumbnailUri,token=_ref.token,onProgress=_ref.onProgress,VIDEO_API_URL=_ref.VIDEO_API_URL;if(!title||!title.trim()){throw new Error("Title is required.");}var formData=new FormData();formData.append("title",title);formData.append("description",description||"");if(videoUri){var ext=videoUri.split(".").pop();var mimeType=Mime.lookup(ext)||"video/mp4";formData.append("video",{uri:videoUri,name:`upload.${ext}`,type:mimeType});}if(thumbnailUri){var _ext=thumbnailUri.split(".").pop();var _mimeType=Mime.lookup(_ext)||"image/jpeg";formData.append("thumbnail",{uri:thumbnailUri,name:`thumb.${_ext}`,type:_mimeType});}console.log("FINAL FORMDATA â†’ ");for(var entry of formData)console.log(entry);var response=yield _axios.default.post(`${VIDEO_API_URL}/api/v1/videos/route-video/`,formData,{headers:{Authorization:`Bearer ${token}`,"Content-Type":"multipart/form-data"},onUploadProgress:function onUploadProgress(evt){if(evt.total){var percent=Math.round(evt.loaded/evt.total*100);onProgress==null?void 0:onProgress(percent);}}});return response.data;});return _uploadVideoMobile.apply(this,arguments);}
var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.uploadVideo=uploadVideo;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _axios=_interopRequireDefault(require("axios"));var _uploadVideoMultipart=require("./uploadVideoMultipart");function uploadVideo(_x){return _uploadVideo.apply(this,arguments);}function _uploadVideo(){_uploadVideo=(0,_asyncToGenerator2.default)(function*(_ref){var title=_ref.title,description=_ref.description,file=_ref.file,thumbnail=_ref.thumbnail,token=_ref.token,VIDEO_API_URL=_ref.VIDEO_API_URL,AWS_API_URL=_ref.AWS_API_URL,channelId=_ref.channelId,UPLOAD_VIDEO_ENDPOINT=_ref.UPLOAD_VIDEO_ENDPOINT;var MULTIPART_PART_URL="api/v1/aws/s3/multipart/part-url";var MULTIPART_COMPLETE_URL="api/v1/aws/s3/multipart/complete";try{var videoKey=yield(0,_uploadVideoMultipart.uploadVideoMultipart)({file:file,channelId:channelId,AWS_API_URL:AWS_API_URL,token:token,filetype:"video",MULTIPART_PART_URL:MULTIPART_PART_URL,MULTIPART_COMPLETE_URL:MULTIPART_COMPLETE_URL});console.log("Video Key from Upload:",videoKey);var thumbnailKey=null;if(thumbnail){thumbnailKey=yield(0,_uploadVideoMultipart.uploadVideoMultipart)({file:thumbnail,channelId:channelId,AWS_API_URL:AWS_API_URL,token:token,filetype:"thumbnail"});console.log("Thumbnail Key from Upload:",thumbnailKey);}var _yield$axios$post=yield _axios.default.post(`${VIDEO_API_URL}${UPLOAD_VIDEO_ENDPOINT}`,{title:title,description:description,videoKey:videoKey,thumbnailKey:thumbnailKey},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${token}`}}),data=_yield$axios$post.data;if(data){console.log("Data from Video Upload:",data);return data;}}catch(err){console.error("Upload Video Package Error:",err);throw err;}});return _uploadVideo.apply(this,arguments);}
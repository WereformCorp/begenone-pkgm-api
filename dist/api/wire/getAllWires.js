var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.getAllWires=void 0;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _axios=_interopRequireDefault(require("axios"));var _calculateTimeAgo=_interopRequireDefault(require("../../utils/calculateTimeAgo"));var cloudFrontDomain="https://dpz1evfcdl4g3.cloudfront.net";var getAllWires=exports.getAllWires=function(){var _ref2=(0,_asyncToGenerator2.default)(function*(_ref){var WIRE_API_URL=_ref.WIRE_API_URL,CHANNEL_API_URL=_ref.CHANNEL_API_URL,_ref$page=_ref.page,page=_ref$page===void 0?1:_ref$page,_ref$limit=_ref.limit,limit=_ref$limit===void 0?10:_ref$limit,GET_ALL_WIRES_ENDPOINT_URL=_ref.GET_ALL_WIRES_ENDPOINT_URL;console.info("GetAllWires | Request started");console.info("WIRE_API_URL:",WIRE_API_URL);console.info("CHANNEL_API_URL:",CHANNEL_API_URL);var wiresRes=yield _axios.default.get(`${WIRE_API_URL}/${GET_ALL_WIRES_ENDPOINT_URL}`,{params:{page:page,limit:limit}});console.info("GetAllWires | Wires response:",wiresRes);var channelsRes=yield _axios.default.get(`${CHANNEL_API_URL}/api/v1/channels/channel-routes/`);var channels=channelsRes.data.data;var channelLogoMap=new Map(channels.map(function(channel){return[channel._id,channel.channelLogo?`${cloudFrontDomain}/${channel.channelLogo}`:null];}));var rawWires=wiresRes.data.data;var wires=rawWires.map(function(wire){return Object.assign({},wire,{timeAgo:(0,_calculateTimeAgo.default)(wire.time)});});return{data:wires,meta:wiresRes.data.meta,channelLogos:Object.fromEntries(channelLogoMap)};});return function getAllWires(_x){return _ref2.apply(this,arguments);};}();